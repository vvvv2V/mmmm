(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{74269:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return Agendar}});var t=l(67294),s=l(97421),n=l(90835),r=l(85893),Scheduling_CalendarPicker=({onDateSelected:e,unavailableDates:a=[]})=>{let[l,s]=(0,t.useState)(new Date),[n,o]=(0,t.useState)(null),getDaysInMonth=e=>new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),getFirstDayOfMonth=e=>new Date(e.getFullYear(),e.getMonth(),1).getDay(),isDateUnavailable=e=>a.some(a=>new Date(a).toDateString()===e.toDateString()),handleDateClick=a=>{let t=new Date(l.getFullYear(),l.getMonth(),a);!isDateUnavailable(t)&&t>=new Date&&(o(t),e(t))};return(0,r.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Selecione a Data"}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("button",{onClick:()=>s(new Date(l.getFullYear(),l.getMonth()-1)),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"←"}),(0,r.jsx)("span",{className:"font-bold",children:l.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),(0,r.jsx)("button",{onClick:()=>s(new Date(l.getFullYear(),l.getMonth()+1)),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"→"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[["Dom","Seg","Ter","Qua","Qui","Sex","Sab"].map(e=>(0,r.jsx)("div",{className:"text-center font-bold text-gray-600",children:e},e)),(()=>{let e=getDaysInMonth(l),a=getFirstDayOfMonth(l),t=[];for(let e=0;e<a;e++)t.push((0,r.jsx)("div",{className:"p-2"},`empty-${e}`));for(let a=1;a<=e;a++){let e=new Date(l.getFullYear(),l.getMonth(),a),s=isDateUnavailable(e),o=n?.toDateString()===e.toDateString(),d=e<new Date;t.push((0,r.jsx)("button",{onClick:()=>handleDateClick(a),disabled:s||d,className:`p-2 rounded text-center font-semibold ${o?"bg-blue-600 text-white":s||d?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white border border-gray-300 hover:bg-blue-100"}`,children:a},a))}return t})()]}),n&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded",children:(0,r.jsxs)("p",{className:"text-sm font-semibold text-blue-800",children:["Data selecionada: ",n.toLocaleDateString("pt-BR")]})})]})},Scheduling_ServiceSelector=({onServiceSelected:e,services:a=[]})=>{let[l,s]=(0,t.useState)([]),n=a.length>0?a:[{id:1,name:"Limpeza Padr\xe3o",price:80,icon:"\uD83E\uDDF9"},{id:2,name:"Limpeza Profunda",price:120,icon:"✨"},{id:3,name:"Mudan\xe7a (In/Out)",price:150,icon:"\uD83D\uDCE6"},{id:4,name:"Limpeza de Vidros",price:30,icon:"\uD83E\uDE9F"},{id:5,name:"Limpeza de Refrigerador",price:25,icon:"❄️"},{id:6,name:"Limpeza de Forno",price:40,icon:"\uD83D\uDD25"}],handleServiceToggle=a=>{let t=l.some(e=>e.id===a.id)?l.filter(e=>e.id!==a.id):[...l,a];s(t),e(t)};return(0,r.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Selecione os Servi\xe7os"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(e=>(0,r.jsx)("button",{onClick:()=>handleServiceToggle(e),className:`p-4 rounded-lg border-2 transition text-left ${l.some(a=>a.id===e.id)?"border-blue-600 bg-blue-50":"border-gray-300 bg-white hover:border-blue-300"}`,children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-bold text-lg",children:[e.icon," ",e.name]}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm mt-1",children:["R$ ",e.price.toFixed(2)]})]}),(0,r.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${l.some(a=>a.id===e.id)?"bg-blue-600 border-blue-600":"border-gray-300"}`,children:l.some(a=>a.id===e.id)&&(0,r.jsx)("span",{className:"text-white text-sm",children:"✓"})})]})},e.id))}),l.length>0&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded",children:[(0,r.jsx)("p",{className:"font-semibold text-blue-900",children:"Servi\xe7os selecionados:"}),(0,r.jsx)("ul",{className:"mt-2 space-y-1",children:l.map(e=>(0,r.jsxs)("li",{className:"text-blue-800 text-sm",children:["• ",e.name," - R$ ",e.price.toFixed(2)]},e.id))})]})]})},o=l(21427),d=l(38810);function Agendar(){let{user:e}=(0,t.useContext)(o.Vo),[a,l]=(0,t.useState)(1),[i,c]=(0,t.useState)(null),[u,x]=(0,t.useState)("10:00"),[m,b]=(0,t.useState)([]),[g,h]=(0,t.useState)(""),[p,f]=(0,t.useState)(""),[j,v]=(0,t.useState)(""),[N,y]=(0,t.useState)([]),[S,w]=(0,t.useState)(null),[D,k]=(0,t.useState)(""),[C,_]=(0,t.useState)(!1),handleSubmit=async()=>{try{if(_(!0),!i||!m.length||!g||!j){alert("⚠️ Por favor, preencha todos os campos obrigat\xf3rios"),_(!1);return}if(!e||!e.id){alert("⚠️ Voc\xea precisa estar autenticado para fazer um agendamento"),_(!1);return}let a={userId:e.id,serviceId:m[0]?.id||1,date:i,time:u,address:g,phone:j,price:calculateTotal(),notes:D},t=await (0,d.k_)("/api/bookings",{method:"POST",body:JSON.stringify(a)});alert(`✅ Agendamento realizado com sucesso!
ID: ${t.booking?.id||"N/A"}`),c(null),x("10:00"),b([]),h(""),v(""),f(""),k(""),l(1)}catch(e){alert(`❌ Erro: ${e.message||"Falha ao agendar. Tente novamente."}`)}finally{_(!1)}},calculateTotal=()=>m.reduce((e,a)=>e+(a.price||0),0);return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,r.jsx)(s.Z,{}),(0,r.jsxs)("main",{className:"flex-grow max-w-4xl mx-auto w-full px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Agendar Servi\xe7o de Limpeza"}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-4",children:[1,2,3,4].map(e=>(0,r.jsx)("div",{className:`flex-1 h-2 mx-1 rounded transition ${e<=a?"bg-blue-600":"bg-gray-300"}`},e))}),(0,r.jsxs)("p",{className:"text-center text-gray-600 font-semibold",children:["Passo ",a," de 4"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[1===a&&(0,r.jsx)(Scheduling_CalendarPicker,{onDateSelected:c}),2===a&&(0,r.jsx)(Scheduling_ServiceSelector,{onServiceSelected:b}),3===a&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Localiza\xe7\xe3o e Detalhes"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold mb-2",children:"Hora Preferida *"}),(0,r.jsx)("input",{type:"time",value:u,onChange:e=>x(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold mb-2",children:"Telefone *"}),(0,r.jsx)("input",{type:"tel",value:j,onChange:e=>v(e.target.value),placeholder:"(11) 9999-9999",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold mb-2",children:"Endere\xe7o Completo *"}),(0,r.jsx)("input",{type:"text",value:g,onChange:e=>h(e.target.value),placeholder:"Rua, n\xfamero, complemento, bairro, cidade",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold mb-2",children:"CEP"}),(0,r.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),placeholder:"00000-000",className:"w-48 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block font-semibold mb-2",children:"Notas Adicionais"}),(0,r.jsx)("textarea",{value:D,onChange:e=>k(e.target.value),placeholder:"Informa\xe7\xf5es adicionais sobre o servi\xe7o...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600",rows:"4"})]})]})]}),4===a&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Resumo do Agendamento"}),(0,r.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg space-y-3",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Data:"})," ",i]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Hora:"})," ",u]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Servi\xe7o:"})," ",m.map(e=>e.name).join(", ")]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Endere\xe7o:"})," ",g]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Telefone:"})," ",j]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Total:"})," R$ ",calculateTotal().toFixed(2)]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between gap-4 mb-8",children:[(0,r.jsx)("button",{onClick:()=>{a>1&&l(a-1)},disabled:1===a,className:"px-6 py-3 border border-gray-300 rounded-lg font-semibold disabled:opacity-50",children:"Voltar"}),a<4?(0,r.jsx)("button",{onClick:()=>{a<4&&l(a+1)},className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700",children:"Pr\xf3ximo"}):(0,r.jsx)("button",{onClick:handleSubmit,disabled:C,className:"px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50",children:C?"⏳ Agendando...":"✅ Confirmar Agendamento"})]})]}),(0,r.jsx)(n.Z,{})]})}},77909:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agendar-updated",function(){return l(74269)}])}},function(e){e.O(0,[857,774,336,216,888,179],function(){return e(e.s=77909)}),_N_E=e.O()}]);